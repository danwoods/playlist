/*! playlist - v0.0.0-23 - 2013-01-02 */
var Catalog=function(e){var t=this,n=new API;t.elm=e,t.$elm=jQuery(e);var r=function(e){var t={id:e.target.getAttribute("data-id"),type:e.target.getAttribute("data-type"),name:$(e.target).find(".name").text()};e.dataTransfer.setData("text/plain",JSON.stringify(t))},i=function(e){var t=e[0].resource.toLowerCase(),n=$('<ol class="'+t+'s" />');return $.each(e,function(e,i){var s=$('<li id="'+i.id+'" class="'+t+'" data-id="'+i.id+'" data-type="'+t+'" draggable="true"><span class="icon"></span><span class="name">'+i.name+"</span></li>");s.get()[0].addEventListener("dragstart",r,!1),n.append(s)}),n};t.$elm.on("click","ol > li.artist > span",function(){var e=$(this).parent(".artist");return e.hasClass("expanded")?e.removeClass("expanded"):e.children("ol").length===0?o(e,{artist_id:e.attr("id")}):e.addClass("expanded"),!1}),t.$elm.on("click","ol > li.album > span",function(){var e=$(this).parent(".album");return e.hasClass("expanded")?e.removeClass("expanded"):e.children("ol").length===0?s(e,{album_id:e.attr("id")}):e.addClass("expanded"),!1});var s=function(e,t,r){n.getSongs({album_id:e.attr("id")},function(t){e.append(i(t.song||t)).addClass("expanded")})},o=function(e,t){n.getAlbums(t,function(t){e.append(i(t.album||t)).addClass("expanded")})},u=function(e,t){n.getArtists(t,function(t){e.append(i(t.artist||t)).addClass("expanded")})};$("document").ready(function(){u(t.$elm)})};